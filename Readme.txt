Multimodal-AlgPro
=================
Multimodal deep learning for allergenic proteins prediction
=================

Author
==================
ljs@swmu.edu.cn


Overview
==================

Multimodal-AlgPro is an advanced deep learning framework designed to enhance allergen prediction by integrating multimodal data sources. By combining sequence, composition, physicochemical properties, and evolutionary information, it delivers robust and accurate allergen predictions. The model employs a character-level convolutional neural network (CNN) to encode amino acid sequences and a densely connected network (DNN) to extract deeper insights from molecular features. Through systematic evaluation of 12 distinct unimodal models (CNN, AAC, AAC_PSSM, CTD, DC, DFMCA_PSSM, DP_PSSM,DPC_PSSM, Pse_PSSM, PSSM_AC,PSSM400, Single_Average) and 2,047 multimodal combinations (Additional file 5: Table S1), we identified the most successful configuration: 'CNN + DFMCA_PSSM + DPC_PSSM + PSSM400 + Single_Average'. This multimodal combination achieved outstanding performance, with average accuracy (93.1%), F-value (92.9%), recall (90.9%), precision (95.1%), MCC (0.863), auROC (0.976), and auPR (0.977). By considering complementary information from five modalities, the framework provides a comprehensive and highly effective approach to allergen prediction.

Usage
==================
You can directly run the generateCMD.py file in the root directory to execute multimodal fusion tests. In this process, 2,047 model combinations are tested, each repeated five times. All results are stored in the "outs" folder, and a comprehensive summary of these results is provided in Table S1.csv, which contains data for all 2,047 combinations.

python examples\Multimodal-AlgPro\generateCMD.py

Command line for Multimodal-AlgPro multimodal training and prediction on independent test set

python running.py --dataType protein other other other other --dataEncodingType onehot other other other other --dataTrainFilePaths ./examples/Multimodal-AlgPro/data/Independent/trpos2840.txt ./examples/Multimodal-AlgPro/data/Independent/trneg2840.txt ./examples/Multimodal-AlgPro/data/Independent/trpo-DFMCA_PSSM.txt ./examples/Multimodal-AlgPro/data/Independent/trne-DFMCA_PSSM.txt ./examples/Multimodal-AlgPro/data/Independent/trpo-dpc_pssm.txt ./examples/Multimodal-AlgPro/data/Independent/trne-dpc_pssm.txt ./examples/Multimodal-AlgPro/data/Independent/trpo-pssm400.txt ./examples/Multimodal-AlgPro/data/Independent/trne-pssm400.txt ./examples/Multimodal-AlgPro/data/Independent/trpo-single_Average.txt ./examples/Multimodal-AlgPro/data/Independent/trne-single_Average.txt --dataTrainLabel 1 0 1 0 1 0 1 0 1 0 --dataTestFilePaths ./examples/Multimodal-AlgPro/data/Independent/tepos710.txt ./examples/Multimodal-AlgPro/data/Independent/teneg710.txt ./examples/Multimodal-AlgPro/data/Independent/tepo-DFMCA_PSSM.txt ./examples/Multimodal-AlgPro/data/Independent/tene-DFMCA_PSSM.txt ./examples/Multimodal-AlgPro/data/Independent/tepo-dpc_pssm.txt ./examples/Multimodal-AlgPro/data/Independent/tene-dpc_pssm.txt ./examples/Multimodal-AlgPro/data/Independent/tepo-pssm400.txt ./examples/Multimodal-AlgPro/data/Independent/tene-pssm400.txt ./examples/Multimodal-AlgPro/data/Independent/tepo-single_Average.txt ./examples/Multimodal-AlgPro/data/Independent/tene-single_Average.txt --dataTestLabel 1 0 1 0 1 0 1 0 1 0 --modelLoadFile ./examples/Multimodal-AlgPro/model/Multimodal/CNN.py ./examples/Multimodal-AlgPro/model/Multimodal/DFMCA_PSSM.py ./examples/Multimodal-AlgPro/model/Multimodal/dpc_pssm.py ./examples/Multimodal-AlgPro/model/Multimodal/pssm400.py ./examples/examples/Multimodal-AlgPro/model/Multimodal/single_Average.py --verbose 1 --showFig 0 --outSaveFolderPath tmpOut --savePrediction 1 --saveFig 1 --batch_size 256 --epochs 20 --shuffleDataTrain 1 --spcLen 1000 1000 1000 1000 1000 --noGPU 0 --paraSaveName parameters.txt --optimizer optimizers.Adam(lr=0.001,amsgrad=False,decay=False) --dataTrainModelInd 0 0 1 1 2 2 3 3 4 4  --dataTestModelInd 0 0 1 1 2 2 3 3 4 4 --modelSaveName tmpMod.json --weightSaveName tmpWeight.bin

Command line for Multimodal-AlgPro multimodal training and prediction on T1E

python running.py --dataType protein other other other other --dataEncodingType onehot other other other other --dataTrainFilePaths ./examples/Multimodal-AlgPro/data/T1E/trpos2840.txt ./examples/Multimodal-AlgPro/data/T1E/trneg2840.txt ./examples/Multimodal-AlgPro/data/T1E/trpo-DFMCA_PSSM.txt ./examples/Multimodal-AlgPro/data/T1E/trne-DFMCA_PSSM.txt ./examples/Multimodal-AlgPro/data/T1E/trpo-dpc_pssm.txt ./examples/Multimodal-AlgPro/data/T1E/trne-dpc_pssm.txt ./examples/Multimodal-AlgPro/data/T1E/trpo-pssm400.txt ./examples/Multimodal-AlgPro/data/T1E/trne-pssm400.txt ./examples/Multimodal-AlgPro/data/T1E/trpo-single_Average.txt ./examples/Multimodal-AlgPro/data/T1E/trne-single_Average.txt --dataTrainLabel 1 0 1 0 1 0 1 0 1 0 --dataTestFilePaths ./examples/Multimodal-AlgPro/data/T1E/tepos710.txt ./examples/Multimodal-AlgPro/data/T1E/teneg710.txt ./examples/Multimodal-AlgPro/data/T1E/tepo-DFMCA_PSSM.txt ./examples/Multimodal-AlgPro/data/T1E/tene-DFMCA_PSSM.txt ./examples/Multimodal-AlgPro/data/T1E/tepo-dpc_pssm.txt ./examples/Multimodal-AlgPro/data/T1E/tene-dpc_pssm.txt ./examples/Multimodal-AlgPro/data/T1E/tepo-pssm400.txt ./examples/Multimodal-AlgPro/data/T1E/tene-pssm400.txt ./examples/Multimodal-AlgPro/data/T1E/tepo-single_Average.txt ./examples/Multimodal-AlgPro/data/T1E/tene-single_Average.txt --dataTestLabel 1 0 1 0 1 0 1 0 1 0 --modelLoadFile ./examples/Multimodal-AlgPro/model/Multimodal/CNN.py ./examples/Multimodal-AlgPro/model/Multimodal/DFMCA_PSSM.py ./examples/Multimodal-AlgPro/model/Multimodal/dpc_pssm.py ./examples/Multimodal-AlgPro/model/Multimodal/pssm400.py ./examples/examples/Multimodal-AlgPro/model/Multimodal/single_Average.py --verbose 1 --showFig 0 --outSaveFolderPath tmpOut --savePrediction 1 --saveFig 1 --batch_size 256 --epochs 20 --shuffleDataTrain 1 --spcLen 1000 1000 1000 1000 1000 --noGPU 0 --paraSaveName parameters.txt --optimizer optimizers.Adam(lr=0.001,amsgrad=False,decay=False) --dataTrainModelInd 0 0 1 1 2 2 3 3 4 4  --dataTestModelInd 0 0 1 1 2 2 3 3 4 4 --modelSaveName tmpMod.json --weightSaveName tmpWeight.bin

Command line for Multimodal-AlgPro multimodal training and prediction on T2E

python running.py --dataType protein other other other other --dataEncodingType onehot other other other other --dataTrainFilePaths ./examples/Multimodal-AlgPro/data/T2E/trpos2840.txt ./examples/Multimodal-AlgPro/data/T2E/trneg2840.txt ./examples/Multimodal-AlgPro/data/T2E/trpo-DFMCA_PSSM.txt ./examples/Multimodal-AlgPro/data/T2E/trne-DFMCA_PSSM.txt ./examples/Multimodal-AlgPro/data/T2E/trpo-dpc_pssm.txt ./examples/Multimodal-AlgPro/data/T2E/trne-dpc_pssm.txt ./examples/Multimodal-AlgPro/data/T2E/trpo-pssm400.txt ./examples/Multimodal-AlgPro/data/T2E/trne-pssm400.txt ./examples/Multimodal-AlgPro/data/T2E/trpo-single_Average.txt ./examples/Multimodal-AlgPro/data/T2E/trne-single_Average.txt --dataTrainLabel 1 0 1 0 1 0 1 0 1 0 --dataTestFilePaths ./examples/Multimodal-AlgPro/data/T2E/tepos710.txt ./examples/Multimodal-AlgPro/data/T2E/teneg710.txt ./examples/Multimodal-AlgPro/data/T2E/tepo-DFMCA_PSSM.txt ./examples/Multimodal-AlgPro/data/T2E/tene-DFMCA_PSSM.txt ./examples/Multimodal-AlgPro/data/T2E/tepo-dpc_pssm.txt ./examples/Multimodal-AlgPro/data/T2E/tene-dpc_pssm.txt ./examples/Multimodal-AlgPro/data/T2E/tepo-pssm400.txt ./examples/Multimodal-AlgPro/data/T2E/tene-pssm400.txt ./examples/Multimodal-AlgPro/data/T2E/tepo-single_Average.txt ./examples/Multimodal-AlgPro/data/T2E/tene-single_Average.txt --dataTestLabel 1 0 1 0 1 0 1 0 1 0 --modelLoadFile ./examples/Multimodal-AlgPro/model/Multimodal/CNN.py ./examples/Multimodal-AlgPro/model/Multimodal/DFMCA_PSSM.py ./examples/Multimodal-AlgPro/model/Multimodal/dpc_pssm.py ./examples/Multimodal-AlgPro/model/Multimodal/pssm400.py ./examples/examples/Multimodal-AlgPro/model/Multimodal/single_Average.py --verbose 1 --showFig 0 --outSaveFolderPath tmpOut --savePrediction 1 --saveFig 1 --batch_size 256 --epochs 20 --shuffleDataTrain 1 --spcLen 1000 1000 1000 1000 1000 --noGPU 0 --paraSaveName parameters.txt --optimizer optimizers.Adam(lr=0.001,amsgrad=False,decay=False) --dataTrainModelInd 0 0 1 1 2 2 3 3 4 4  --dataTestModelInd 0 0 1 1 2 2 3 3 4 4 --modelSaveName tmpMod.json --weightSaveName tmpWeight.bin

Command line for Multimodal-AlgPro multimodal training and prediction on T3E

python running.py --dataType protein other other other other --dataEncodingType onehot other other other other --dataTrainFilePaths ./examples/Multimodal-AlgPro/data/T3E/trpos2840.txt ./examples/Multimodal-AlgPro/data/T3E/trneg2840.txt ./examples/Multimodal-AlgPro/data/T3E/trpo-DFMCA_PSSM.txt ./examples/Multimodal-AlgPro/data/T3E/trne-DFMCA_PSSM.txt ./examples/Multimodal-AlgPro/data/T3E/trpo-dpc_pssm.txt ./examples/Multimodal-AlgPro/data/T3E/trne-dpc_pssm.txt ./examples/Multimodal-AlgPro/data/T3E/trpo-pssm400.txt ./examples/Multimodal-AlgPro/data/T3E/trne-pssm400.txt ./examples/Multimodal-AlgPro/data/T3E/trpo-single_Average.txt ./examples/Multimodal-AlgPro/data/T3E/trne-single_Average.txt --dataTrainLabel 1 0 1 0 1 0 1 0 1 0 --dataTestFilePaths ./examples/Multimodal-AlgPro/data/T3E/tepos710.txt ./examples/Multimodal-AlgPro/data/T3E/teneg710.txt ./examples/Multimodal-AlgPro/data/T3E/tepo-DFMCA_PSSM.txt ./examples/Multimodal-AlgPro/data/T3E/tene-DFMCA_PSSM.txt ./examples/Multimodal-AlgPro/data/T3E/tepo-dpc_pssm.txt ./examples/Multimodal-AlgPro/data/T3E/tene-dpc_pssm.txt ./examples/Multimodal-AlgPro/data/T3E/tepo-pssm400.txt ./examples/Multimodal-AlgPro/data/T3E/tene-pssm400.txt ./examples/Multimodal-AlgPro/data/T3E/tepo-single_Average.txt ./examples/Multimodal-AlgPro/data/T3E/tene-single_Average.txt --dataTestLabel 1 0 1 0 1 0 1 0 1 0 --modelLoadFile ./examples/Multimodal-AlgPro/model/Multimodal/CNN.py ./examples/Multimodal-AlgPro/model/Multimodal/DFMCA_PSSM.py ./examples/Multimodal-AlgPro/model/Multimodal/dpc_pssm.py ./examples/Multimodal-AlgPro/model/Multimodal/pssm400.py ./examples/examples/Multimodal-AlgPro/model/Multimodal/single_Average.py --verbose 1 --showFig 0 --outSaveFolderPath tmpOut --savePrediction 1 --saveFig 1 --batch_size 256 --epochs 20 --shuffleDataTrain 1 --spcLen 1000 1000 1000 1000 1000 --noGPU 0 --paraSaveName parameters.txt --optimizer optimizers.Adam(lr=0.001,amsgrad=False,decay=False) --dataTrainModelInd 0 0 1 1 2 2 3 3 4 4  --dataTestModelInd 0 0 1 1 2 2 3 3 4 4 --modelSaveName tmpMod.json --weightSaveName tmpWeight.bin


UMAP Visualization
==================
python tool/layerUMAP.py --paraFile tmpOut/parameters.txt --outFigFolder tmpOut --metric cosine --n_neighbors 28 --min_dist 0.8 --interactive 1

SHAP analysis
==================
Please run the 'Multimodal interpretability.ipynb' file located in the notebook folder.


Single model command
==================
1.  Text modality (CNN, BiLSTM, Transformer):
python running.py --dataType protein --dataEncodingType onehot --dataTrainFilePaths ./examples/Multimodal-AlgPro/data/Independent/trpos2840.txt ./examples/Multimodal-AlgPro/data/Independent/trneg2840.txt --dataTrainLabel 1 0 --dataSplitScale 0.8 --modelLoadFile ./examples/Multimodal-AlgPro/model/Unimodal/CNN.py --verbose 1 --outSaveFolderPath tmpOut --savePrediction 1 --showFig 0 --saveFig 1 --batch_size 256 --epochs 20 --shuffleDataTrain 1 --spcLen 2000 --noGPU 1 --paraSaveName parameters.txt --optimizer optimizers.Adam(lr=0.001,amsgrad=False,decay=False) --modelSaveName tmpMod.json --weightSaveName tmpWeight.bin

2. Feature modality (PSSM, AAC, DC, CTD):
python running.py --dataType other --dataEncodingType other --dataTrainFilePaths ./examples/Multimodal-AlgPro/data/Independent/trpo-pssm_ac.txt ./examples/Multimodal-AlgPro/data/Independent/trne-pssm_ac.txt --dataTrainLabel 1 0 --dataSplitScale 0.8 --modelLoadFile ./examples/Multimodal-AlgPro/model/Unimodal/pssm_ac.py --verbose 1 --outSaveFolderPath tmpOut --savePrediction 1 --showFig 0 --saveFig 1 --batch_size 256 --epochs 20 --shuffleDataTrain 1 --spcLen 1000 --noGPU 0 --paraSaveName parameters.txt --optimizer optimizers.Adam(lr=0.001,amsgrad=False,decay=False) --modelSaveName tmpMod.json --weightSaveName tmpWeight.bin


(*Note that the single model CNN or DNN should include a sigmoid activation function in the output layer)



